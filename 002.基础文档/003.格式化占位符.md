# go 语言中的格式化占位符

## 1. 描述

## 1.1 描述

go 语言中有很多打印，输出函数都带有 f 后缀，该后缀表示对字符串内容格式化

## 1.2 参考链接

- https://blog.csdn.net/haeasringnar/article/details/84495075

## 2. 占位符(占位符在不同的函数中有不同，以下占位符在 fmt.Printf 中均实现)

### 2.1 占位符标记

- 一般 占位符
    - %%: 输出百分号本身
    - %T: 值类型占位
    - %v: 打印原始值
    - %+v: 在打印结构体时添加字段名
    - %#v: 类型，值原样输出
- bool 占位符
    - %t: 单词 true 或 false
- 整数 占位符
    - %b: 二进制表示
    - %o: 八进制表示
    - %d: 十进制表示
    - %x: 十六进制表示，字母形式为小写 a-f
    - %X: 十六进制表示，字母形式为大写 A-F
    - %U: Unicode 格式：U+1234，等同于 "U+%04X"
    - %c: 相应 Unicode 码点所表示的字符
    - %q: 单引号围绕的字符字面值，由 Go 语法安全地转义
- 浮点数及其符合构成 占位符
    - %f: 有小数点，eg: 123.456
    - %e: 科学计数法(e)，eg: -1234.456e+78
    - %E: 科学计数法(E)，eg: -1234.456E+78
    - %b: 无小数部分的，指数为二的幂的科学计数法，eg: -123456p-78
    - %g: 根据情况选择 %e 或 %f 以产生更紧凑的（无末尾的 0）输出
    - %G: 根据情况选择 %E 或 %f 以产生更紧凑的（无末尾的 0）输出
- 字符串与字节切片 占位符
    - %s: 字符串或切片的无解译字节
    - %q: 双引号围绕的字符串，由 Go 语法安全地转义
    - %x: 十六进制，小写字母，每字节两个字符
    - %X: 十六进制，大写字母，每字节两个字符
- 指针 占位符
    - %p: 十六进制表示，前缀 0x

### 2.2 宽度和精度

- 对于字符串、整数
    - %s: 原样输出
    - %8s: 8 为宽度，不足前位用 " " 补足
    - %08s: 8 为宽度，不足前位用 "0" 补足
- 对于整数
    - %d: 原样输出
    - %8d: 8 为宽度，不足前位用 " " 补足
    - %08d: 8 为宽度，不足前位用 "0" 补足
- 对于浮点数(对于浮点数，小数点"."也算一位总长)
    - %f: 原样输出
    - %8.3f: 总长度位为8，3位小数，前位补 " "
    - %08.3f: 总长度位为8，3位小数，前位补 "0"
    - %.3f: 总长度位不限，3位小数
- 对于字符串
    - %8q: 最小长度为8(包含输出的前后两位引号)
    - %.8q: 最大长度为8(不包含输出的前后两位引号)，多余的直接截断

### 2.3 其它标记

- +: 总打印数值的正负号；对于 %q（%+q）保证只输出 ASCII 编码的字符。
- -: 在右侧而非左侧填充空格(左对齐该区域)
- #: 备用格式
    - 为二进制添加前导 0b（%#b）
    - 为八进制添加前导 0（%#o）
    - 为十六进制添加前导 0x（%#x）或 0X（%#X）
    - 为 %p（%#p）去掉前导 0x
    - %q（%#q）会打印原始（即反引号围绕的）字符串；
    - 可打印字符，%U（%#U）会写出该字符的 Unicode 编码形式（如字符 x 会被打印成 U+0078 'x'）
- " ": 空格
    - 为数值中省略的正负号留出空白(% d)
    - 以十六进制（% x, % X）打印字符串或切片时，在字节之间用空格隔开
- 0: 填充前导的 0 而非空格,对于数字，这会将填充移到正负号之后

## 3. demo

```go
package main

import (
	"fmt"
)

type myStruct1 struct {
	name string
	age  int
}

func main() {
	s1 := "11"
	fmt.Printf("百分号: %%, 类型: %T, 原始输出: %[1]v, 输出: %#[1]v\n", s1)
	m1 := map[string]int{"a": 1, "b": 2}
	fmt.Printf("类型: %T, 原始输出: %[1]v, 输出: %#[1]v\n", m1)
	myS1 := myStruct1{
		name: "a",
		age:  11,
	}
	fmt.Printf("类型: %T, 原始输出: %[1]v, 结构体字段输出: %+[1]v, 结构体字段输出: %#[1]v\n", myS1)
	i1 := 97
	fmt.Printf("二进制表示: %b %#[1]b\n", i1)
	fmt.Printf("八进制表示: %o\n", i1)
	fmt.Printf("十进制表示: %d\n", i1)
	fmt.Printf("十六进制小写表示: %x\n", i1)
	fmt.Printf("十六进制大写表示: %X\n", i1)
	fmt.Printf("Unicode: %U, %#[1]U\n", i1) // U+0061
	fmt.Printf("字符: %c\n", i1)
	fmt.Printf("带引号字符: %q\n", i1)

	f1 := 1212.121
	fmt.Printf("有小数点而无指数: %f\n", f1)
	fmt.Printf("科学计数法: %e\n", f1)
	fmt.Printf("科学计数法: %E\n", f1)
	fmt.Printf("无小数部分的，指数为二的幂的科学计数法: %b\n", f1)
	fmt.Printf("根据情况选择%%e 或 %%f: %g\n", f1)
	fmt.Printf("根据情况选择%%E 或 %%f: %G\n", f1)

	// 宽度
	s2 := "HelloWorld"
	fmt.Printf("原样输出string:%#v", s2)
	fmt.Printf("超过宽度原样输出, 8位宽度(%8s)\n", s2)
	fmt.Printf("宽度不够，前位空格补足, 15位宽度(%15s)\n", s2)
	fmt.Printf("宽度不够，前位补0, 15位宽度(%015s)\n", s2)
	// 字符串带引号截断
	fmt.Printf("%8q\n", "1234")       // 最小长度为8(包含输出的前后两位引号)
	fmt.Printf("%.8q\n", "123456789") // 最大长度为8(不包含输出的前后两位引号)

	// 宽度与精度标记字符串
	i2 := 123456
	fmt.Printf("原样输出: %d\n", i2)
	fmt.Printf("总长度位8(前位为空): %8d\n", i2)
	fmt.Printf("总长度位8(前位补0): %08d\n", i2)
	f2 := 12.11
	fmt.Printf("原样输出: %f\n", f2)
	fmt.Printf("总长度位8(前位为空)，小数位为3: %8.3f\n", f2)
	fmt.Printf("总长度位18(前位补0)，小数位为3: %08.3f\n", f2)
	fmt.Printf("总长度位不限，小数位为3: %.3f\n", f2)

	s3 := "qin"
	fmt.Printf("string: %s, %# [1]x\n", s3) // %#x 表示16进制并有前导符 0x， 中间空格分开，
}

```

```
=== output === 
go run test.go
百分号: %, 类型: string, 原始输出: 11, 输出: "11"
类型: map[string]int, 原始输出: map[a:1 b:2], 输出: map[string]int{"a":1, "b":2}
类型: main.myStruct1, 原始输出: {a 11}, 结构体字段输出: {name:a age:11}, 结构体字段输出: main.myStruct1{name:"a", age:11}
二进制表示: 1100001 0b1100001
八进制表示: 141
十进制表示: 97
十六进制小写表示: 61
十六进制大写表示: 61
Unicode: U+0061, U+0061 'a'
字符: a
带引号字符: 'a'
有小数点而无指数: 1212.121000
科学计数法: 1.212121e+03
科学计数法: 1.212121E+03
无小数部分的，指数为二的幂的科学计数法: 5330964535085892p-42
根据情况选择%e 或 %f: 1212.121
根据情况选择%E 或 %f: 1212.121
原样输出string:"HelloWorld"超过宽度原样输出, 8位宽度(HelloWorld)
宽度不够，前位空格补足, 15位宽度(     HelloWorld)
宽度不够，前位补0, 15位宽度(00000HelloWorld)
  "1234"
"12345678"
原样输出: 123456
总长度位8(前位为空):   123456
总长度位8(前位补0): 00123456
原样输出: 12.110000
总长度位8(前位为空)，小数位为3:   12.110
总长度位18(前位补0)，小数位为3: 0012.110
总长度位不限，小数位为3: 12.110
string: qin, 0x71 0x69 0x6e
```